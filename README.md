# Predicting CO2 Plume Migration in Heterogeneous Formations by Deep Learning
This Python 3.5/Pytorch package contains the conditional deep convolutional generative adversarial network (cDC-GAN), which is used to predict the CO2 plume migration and CO2 staturation distribution. 
## Introduction
In this work, we first present the network struture of cDC-GAN and then demonstrate its performance in training a surrogate model for predicting the CO2 plume migration in heterogeneous reservoirs. Although our application area is CCS, the deep-learning-based approach has practical implications for many other subsurface displines that involve the use of high-fidelity surrogate models. This paper is organized as follows. 
## GAN network structure
For the cDC-GAN design, the generator **__G__** and discriminator **__D__** share a similar structure as used in the pix2pix (i.e., image-to-image mapping) work (Isola et al., 2017), which includes a series of convolutional and deconvolutional layers to help discover high level features at multiple scales. 

## Experiment Designment
We consider a 2D hypothetical carbon storage aquifer with spatially heterogeneous reservoir properties. The model dimensions are 1280m x 1280m with a uniform lateral grid block size of 10m x 10m and a layer thickness of 20m. The aquifer is confined by overlying and underlying seals (i.e., no-flow boundary in the direction perpendicular to the aquifer). Infinite acting boundary conditions (Dirichlet) are imposed on all lateral sides of the aquifer. The initial reservoir pressure is 11Mpa, at a constant temperature of 45 C. A CO2 injection well is located in the center of the aquifer at grid block location (64, 64), with a constant injection rate of 5 x 10<sup>5</sup> m<sup>3</sup>/d (at standard surface condition) and is constrained by the maximum bottom-hole pressure of 3x10<sup>4</sup>kPa. The total simulation time is 380 days. To generate CO2 saturation maps for surrogate model training and testing, outputs from 22 time steps are saved, including 15–180 day in 15-day intervals and then 180 –380 day in 20-day intervals.
## Result
please refer the paper
## Conclusion 
The generative adversarial networks (GANs), a type of deep learning models, have shown promising performance in learning cross-domain mappings. In this work, we adopt a GAN framework to develop surrogate models of high-dimensional dynamical numerical models, which has been extensively studied but remains a challenging task under the conventional surrogate modeling and reduced-order modeling frameworks. In particular, we have developed a conditional deep convolutional generative adversarial network (cDC-GAN) for surrogate modeling. The developed cDC-GAN model is demonstrated for a carbon capture and storage (CCS) use case, for which we seek to predict the spatial and temporal evolution of injected CO2 plume in heterogeneous formations. The underlying multiphase flow and transport problem is highly nonlinear and normally solved via compositional reservoir simulation, which is computationally expensive even on high-performance clusters. The cDC-GAN is trained to learn the mappings between two domains, the model input domain is permeability field and the output domain is the dynamic CO2 saturation fields. The conditioning data is the model output time. Our results indicate that cDC-GAN has strong skills in learning the inherent mappings between the permeability fields and simulated CO2 plumes. By feeding it with different stochastic realizations of the permeability, the cDC-GAN is trained to learn a generalized mapping that can handle different cases from the same data distribution class. The performance of the cDC-GAN is consistent when the heterogeneity structure changes (e.g., different correlation ranges). It also interpolates well for time steps not used in training, which is an important attribute to have for high-quality surrogate models. As part of the study, we also look “under the hood” of cDC-GAN and show that the extracted feature maps can be interpreted meaningfully. It is worth pointing out that unlike many surrogate models that either assume a linear system or require parametric probability distribution functions, cDC-GAN imposes few assumptions on the input data and is entirely data driven. Thus, it can be potentially applied to a large class of physical simulation problems for similar risk-assessment and UQ tasks.
## Data Files
The training and testing dataset used in this research are collected from commerical reservoir simulation software (CMG), due to the Github space limits, we just upload partical dataset. But total dataset are avaliabel, so please email me if you want to get those data. 

## License
The pytorch/python code for the conditional deep convolutional generative adversarial neural network (cDC-GAN) is under MIT license. See the corresponding folders for details.

## Contact
Zhi Zhong (zhi.zhong@beg.utexas.edu, zizhong1990@gmail.com)
Alexander Y. Sun (alex.sun@beg.utexas.edu)
